---
  import { getLiveCollection } from "astro:content";
  import Lightbox from "../components/Lightbox.astro";
  import BaseLayout from "../layouts/BaseLayout.astro";
  import PhotoCard from "../components/PhotoCard.astro";

  export const prerender = false;

  Astro.response.headers.set("Cache-Control", "public, max-age=3600");

  const { entries: photos } = await getLiveCollection("photos");
  const col1 = photos.filter((_, i) => i % 2 === 0);
  const col2 = photos.filter((_, i) => i % 2 === 1);
---
<BaseLayout title="Photos" description="Random dump of unedited photos.">
  <section>
    <h2 class="font-mono text-xs font-medium uppercase tracking-wider text-tertiary mb-6">
      Photos
    </h2>
    {photos && photos.length > 0 ? (
      <>
        {/* Mobile View: Sequential */}
        <div class="flex flex-col gap-4 xs:hidden">
          {photos.map(({ data: photo }, index: number) => (
            <PhotoCard photo={photo} index={index} />
          ))}
        </div>

        {/* Desktop View: Masonry Split (1-2, 3-4 ordering visual) */}
        <div class="hidden xs:grid xs:grid-cols-2 gap-4 items-start">
          <div class="flex flex-col gap-4">
            {col1.map(({ data: photo }, index: number) => (
              <PhotoCard photo={photo} index={index * 2} />
            ))}
          </div>
          <div class="flex flex-col gap-4">
            {col2.map(({ data: photo }, index: number) => (
              <PhotoCard photo={photo} index={index * 2 + 1} />
            ))}
          </div>
        </div>
      </>
    ) : (
      <div class="py-12 text-center">
        <div class="text-tertiary font-mono text-sm mb-2">No photos yet</div>
        <p class="text-secondary text-sm">Photo gallery will appear here</p>
      </div>
    )}
  </section>
  <Lightbox/>
</BaseLayout>
