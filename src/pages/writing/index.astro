---
  import { type CollectionEntry, getCollection } from "astro:content";
  import BaseLayout from "../../layouts/BaseLayout.astro";
  import { formatDate } from "../../lib/utils";

  export const prerender = true;

  const posts = await getCollection("writings");
---
<BaseLayout title="Writing" description="A collection of my writings, rants and incomplete notes.">
  <section>
    <h2 class="font-mono text-xs font-medium uppercase tracking-wider text-tertiary mb-6">
      Writing
    </h2>
    {
        posts.length > 0 ? (
          <ul class="list-none">
        {posts.map((post: CollectionEntry<"writings">) => (
              <li class="py-8 border-b border-border first:pt-0 last:border-b-0">
                <a href={`/writing/${post.data.slug}`} class="post-link block" >
                  <div class="text-lg font-semibold mb-2 text-primary hover:text-accent">{post.data.title}</div>
                        <div class="flex gap-2 items-center mb-3">
                            <span class="font-mono text-xs text-tertiary">{formatDate(post.data.publishedAt!)}</span>
                            <span class="text-tertiary">Â·</span>
                            <span class="font-mono text-xs text-tertiary">{post.data.readingTime}</span>
                        </div>
                        <p class="text-secondary leading-relaxed line-clamp-2">{post.data.description}</p>
                    </a>
                </li>
            ))}
          </ul>
          ) : (
           <div class="py-12 text-center">
                <div class="text-tertiary font-mono text-sm mb-2">No posts yet</div>
                <p class="text-secondary text-sm">Writing will appear here</p>
            </div>
        )
      }
  </section>
</BaseLayout>
